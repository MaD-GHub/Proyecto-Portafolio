<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinaWase - Dashboard de Administraci칩n</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
      /* Estilo para las tarjetas del dashboard */
      .dashboard-card {
        transition: all 0.3s ease;
      }
      .dashboard-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      /* Sidebar fondo en gradiente */
      .gradient-bg {
      background: linear-gradient(135deg, #7f00ff 0%, #e100ff 100%);
    }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Sidebar -->
    <div class="flex">
        <aside class="w-64 bg-purple-900 h-full text-white flex flex-col">
            <!-- Logo Seccion -->
            <div class="p-6 flex items-center justify-center border-b border-purple-700">
              <img src="img/Logo_finawise_blanco_shadowpurple.png" alt="Logo de la App" class="h-24">
            </div>
      
            <!-- Sidebar Links -->
            <nav class="flex-grow p-6">
              <a href="#" class="block py-2 px-4 mb-2 rounded hover:bg-purple-700">游늵 Resumen Financiero</a>
              <a href="#" class="block py-2 px-4 mb-2 rounded hover:bg-purple-700">游늳 Progreso de Usuarios</a>
              <a href="#" class="block py-2 px-4 mb-2 rounded hover:bg-purple-700">游눺 Estad칤sticas</a>
              <a href="#" class="block py-2 px-4 mb-2 rounded hover:bg-purple-700">丘뙖잺 Configuraci칩n</a>
            </nav>
      
            <!-- Logout -->
            <div class="p-6">
              <button class="w-full py-2 bg-purple-700 text-white rounded hover:bg-purple-600">Cerrar sesi칩n</button>
            </div>
          </aside>

      <!-- Main Content -->
      <div class="flex-1 p-6">
        <!-- Header -->
          <div class="ashboard-card bg-white p-6 mb-4 rounded-lg shadow-md">
            <h1 class="text-2xl font-bold">FinaWase - Dashboard de Gr치ficos Financieros</h1>
          </div>

        <!-- Tarjetas -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-2">Usuarios Totales</h2>
            <p id="totalUsers" class="text-3xl font-bold text-blue-600">-</p>
          </div>
          <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-2">Transacciones Hoy</h2>
            <p id="todayTransactions" class="text-3xl font-bold text-green-600">-</p>
          </div>
          <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-2">Ingresos Totales</h2>
            <p id="totalIncome" class="text-3xl font-bold text-purple-600">-</p>
          </div>
          <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-2">Gastos Totales</h2>
            <p id="totalExpenses" class="text-3xl font-bold text-red-600">-</p>
          </div>
        </div>

        <!-- Gr치ficos -->
        <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Nuevos Usuarios (칔ltimos 7 d칤as)</h2>
            <canvas id="newUsersChart"></canvas>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Distribuci칩n de Gastos</h2>
            <canvas id="expensesDistributionChart"></canvas>
          </div>
        </div>

        <!-- Tabla de Transacciones -->
        <div class="mt-8 bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold mb-4">칔ltimas Transacciones</h2>
          <div class="overflow-x-auto">
            <table class="w-full table-auto">
              <thead>
                <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                  <th class="py-3 px-6 text-left">Usuario</th>
                  <th class="py-3 px-6 text-left">Tipo</th>
                  <th class="py-3 px-6 text-left">Categor칤a</th>
                  <th class="py-3 px-6 text-left">Monto</th>
                  <th class="py-3 px-6 text-left">Fecha</th>
                </tr>
              </thead>
              <tbody id="transactionsTable" class="text-gray-600 text-sm font-light">
                <!-- Las filas de transacciones se agregar치n aqu칤 din치micamente -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script>
        // Configuraci칩n de Firebase
        // const firebaseConfig = {
        //   apiKey: "YOUR_API_KEY",
        //   authDomain: "YOUR_AUTH_DOMAIN",
        //   projectId: "YOUR_PROJECT_ID",
        //   storageBucket: "YOUR_STORAGE_BUCKET",
        //   messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        //   appId: "YOUR_APP_ID"
        // };

        // // Inicializar Firebase
        // firebase.initializeApp(firebaseConfig);
        // const db = firebase.firestore();

        // Funci칩n para obtener datos del dashboard
        async function getDashboardData() {
          try {
            const usersSnapshot = await db.collection('users').get();
            const transactionsSnapshot = await db.collection('transactions').get();

            const totalUsers = usersSnapshot.size;
            let todayTransactions = 0;
            let totalIncome = 0;
            let totalExpenses = 0;

            const today = new Date();
            today.setHours(0, 0, 0, 0);

            transactionsSnapshot.forEach(doc => {
              const transaction = doc.data();
              const transactionDate = transaction.date.toDate();

              if (transactionDate >= today) {
                todayTransactions++;
              }

              if (transaction.type === 'income') {
                totalIncome += transaction.amount;
              } else {
                totalExpenses += transaction.amount;
              }
            });

            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('todayTransactions').textContent = todayTransactions;
            document.getElementById('totalIncome').textContent = `$${totalIncome.toFixed(2)}`;
            document.getElementById('totalExpenses').textContent = `$${totalExpenses.toFixed(2)}`;

            // Aqu칤 puedes llamar a funciones para actualizar los gr치ficos
            updateNewUsersChart();
            updateExpensesDistributionChart();
            updateTransactionsTable();
          } catch (error) {
            console.error("Error al obtener datos del dashboard:", error);
          }
        }

        // Gr치fico de Nuevos Usuarios
        function updateNewUsersChart() {
          const ctx = document.getElementById('newUsersChart').getContext('2d');
          new Chart(ctx, {
            type: 'line',
            data: {
              labels: ['Lun', 'Mar', 'Mi칠', 'Jue', 'Vie', 'S치b', 'Dom'],
              datasets: [{
                label: 'Nuevos Usuarios',
                data: [12, 19, 3, 5, 2, 3, 7],
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
              }]
            },
            options: {
              responsive: true,
              scales: {
                y: {
                  beginAtZero: true
                }
              }
            }
          });
        }

        // Gr치fico de Distribuci칩n de Gastos
        function updateExpensesDistributionChart() {
          const ctx = document.getElementById('expensesDistributionChart').getContext('2d');
          new Chart(ctx, {
            type: 'doughnut',
            data: {
              labels: ['Comida', 'Transporte', 'Entretenimiento', 'Servicios', 'Otros'],
              datasets: [{
                data: [30, 20, 15, 25, 10],
                backgroundColor: [
                  'rgb(255, 99, 132)',
                  'rgb(54, 162, 235)',
                  'rgb(255, 206, 86)',
                  'rgb(75, 192, 192)',
                  'rgb(153, 102, 255)'
                ]
              }]
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  position: 'top',
                },
                title: {
                  display: true,
                  text: 'Distribuci칩n de Gastos'
                }
              }
            }
          });
        }

        // Actualizaci칩n de tabla de transacciones
        function updateTransactionsTable() {
          const transactionsTable = document.getElementById('transactionsTable');
          const transactions = [
            { user: 'usuario1@example.com', type: 'Ingreso', category: 'Salario', amount: 1000, date: '2023-04-15' },
            { user: 'usuario2@example.com', type: 'Gasto', category: 'Comida', amount: 50, date: '2023-04-14' },
            { user: 'usuario3@example.com', type: 'Gasto', category: 'Transporte', amount: 30, date: '2023-04-13' }
          ];

          transactions.forEach(transaction => {
            const row = `
              <tr class="border-b border-gray-200 hover:bg-gray-100">
                <td class="py-3 px-6 text-left whitespace-nowrap">${transaction.user}</td>
                <td class="py-3 px-6 text-left">${transaction.type}</td>
                <td class="py-3 px-6 text-left">${transaction.category}</td>
                <td class="py-3 px-6 text-left">$${transaction.amount.toFixed(2)}</td>
                <td class="py-3 px-6 text-left">${transaction.date}</td>
              </tr>
            `;
            transactionsTable.innerHTML += row;
          });
        }

        // Evento de cierre de sesi칩n
        document.getElementById('logoutBtn').addEventListener('click', () => {
          firebase.auth().signOut().then(() => {
            window.location.href = '/login';
          }).catch((error) => {
            console.error("Error al cerrar sesi칩n:", error);
          });
        });

        // Cargar datos del dashboard al cargar la p치gina
        document.addEventListener('DOMContentLoaded', getDashboardData);
    </script>
</body><!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinaWase - Dashboard de Administraci칩n</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
      /* Estilo para las tarjetas del dashboard */
      .dashboard-card {
        transition: all 0.3s ease;
      }
      .dashboard-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      /* Sidebar en gradiente */
      .sidebar-bg {
        background: linear-gradient(135deg, #7f00ff 0%, #e100ff 100%);
      }

      /* Hacer que el sidebar ocupe toda la pantalla y siga en scroll */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        width: 16rem;
      }

      /* Ajuste del padding para evitar que el contenido principal quede detr치s de la sidebar */
      .main-content {
        margin-left: 16rem;
      }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Sidebar -->
    <div class="sidebar sidebar-bg text-white">
      <div class="p-6">
        <h2 class="text-2xl font-bold">FinaWase Admin</h2>
      </div>
      <nav class="p-6">
        <a href="#" class="block py-2 px-4 mb-4 bg-purple-700 rounded hover:bg-purple-600">游늵 Gr치ficos Financieros</a>
        <a href="#" class="block py-2 px-4 mb-4 hover:bg-purple-600">游늳 Resumen de Usuarios</a>
        <a href="#" class="block py-2 px-4 mb-4 hover:bg-purple-600">丘뙖잺 Configuraci칩n</a>
      </nav>
      <div class="p-6">
        <button id="logoutBtn" class="w-full py-2 bg-red-500 hover:bg-red-600 text-white rounded">Cerrar sesi칩n</button>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content p-6">
      <!-- Tarjetas -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold mb-2">Usuarios Totales</h2>
          <p id="totalUsers" class="text-3xl font-bold text-blue-600">-</p>
        </div>
        <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold mb-2">Transacciones Hoy</h2>
          <p id="todayTransactions" class="text-3xl font-bold text-green-600">-</p>
        </div>
        <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold mb-2">Ingresos Totales</h2>
          <p id="totalIncome" class="text-3xl font-bold text-purple-600">-</p>
        </div>
        <div class="dashboard-card bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold mb-2">Gastos Totales</h2>
          <p id="totalExpenses" class="text-3xl font-bold text-red-600">-</p>
        </div>
      </div>

      <!-- Gr치ficos -->
      <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold mb-4">Nuevos Usuarios (칔ltimos 7 d칤as)</h2>
          <canvas id="newUsersChart"></canvas>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold mb-4">Distribuci칩n de Gastos</h2>
          <canvas id="expensesDistributionChart"></canvas>
        </div>
      </div>

      <!-- Tabla de Transacciones -->
      <div class="mt-8 bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-xl font-semibold mb-4">칔ltimas Transacciones</h2>
        <div class="overflow-x-auto">
          <table class="w-full table-auto">
            <thead>
              <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                <th class="py-3 px-6 text-left">Usuario</th>
                <th class="py-3 px-6 text-left">Tipo</th>
                <th class="py-3 px-6 text-left">Categor칤a</th>
                <th class="py-3 px-6 text-left">Monto</th>
                <th class="py-3 px-6 text-left">Fecha</th>
              </tr>
            </thead>
            <tbody id="transactionsTable" class="text-gray-600 text-sm font-light">
              <!-- Las filas de transacciones se agregar치n aqu칤 din치micamente -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script>
        // Configuraci칩n de Firebase
        const firebaseConfig = {
          apiKey: "YOUR_API_KEY",
          authDomain: "YOUR_AUTH_DOMAIN",
          projectId: "YOUR_PROJECT_ID",
          storageBucket: "YOUR_STORAGE_BUCKET",
          messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
          appId: "YOUR_APP_ID"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Funci칩n para obtener datos del dashboard
        async function getDashboardData() {
          try {
            const usersSnapshot = await db.collection('users').get();
            const transactionsSnapshot = await db.collection('transactions').get();

            const totalUsers = usersSnapshot.size;
            let todayTransactions = 0;
            let totalIncome = 0;
            let totalExpenses = 0;

            const today = new Date();
            today.setHours(0, 0, 0, 0);

            transactionsSnapshot.forEach(doc => {
              const transaction = doc.data();
              const transactionDate = transaction.date.toDate();

              if (transactionDate >= today) {
                todayTransactions++;
              }

              if (transaction.type === 'income') {
                totalIncome += transaction.amount;
              } else {
                totalExpenses += transaction.amount;
              }
            });

            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('todayTransactions').textContent = todayTransactions;
            document.getElementById('totalIncome').textContent = `$${totalIncome.toFixed(2)}`;
            document.getElementById('totalExpenses').textContent = `$${totalExpenses.toFixed(2)}`;

            // Aqu칤 puedes llamar a funciones para actualizar los gr치ficos
            updateNewUsersChart();
            updateExpensesDistributionChart();
            updateTransactionsTable();
          } catch (error) {
            console.error("Error al obtener datos del dashboard:", error);
          }
        }

        // Gr치fico de Nuevos Usuarios
        function updateNewUsersChart() {
          const ctx = document.getElementById('newUsersChart').getContext('2d');
          new Chart(ctx, {
            type: 'line',
            data: {
              labels: ['Lun', 'Mar', 'Mi칠', 'Jue', 'Vie', 'S치b', 'Dom'],
              datasets: [{
                label: 'Nuevos Usuarios',
                data: [12, 19, 3, 5, 2, 3, 7],
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
              }]
            },
            options: {
              responsive: true,
              scales: {
                y: {
                  beginAtZero: true
                }
              }
            }
          });
        }

        // Gr치fico de Distribuci칩n de Gastos
        function updateExpensesDistributionChart() {
          const ctx = document.getElementById('expensesDistributionChart').getContext('2d');
          new Chart(ctx, {
            type: 'doughnut',
            data: {
              labels: ['Comida', 'Transporte', 'Entretenimiento', 'Servicios', 'Otros'],
              datasets: [{
                data: [30, 20, 15, 25, 10],
                backgroundColor: [
                  'rgb(255, 99, 132)',
                  'rgb(54, 162, 235)',
                  'rgb(255, 206, 86)',
                  'rgb(75, 192, 192)',
                  'rgb(153, 102, 255)'
                ]
              }]
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  position: 'top',
                },
                title: {
                  display: true,
                  text: 'Distribuci칩n de Gastos'
                }
              }
            }
          });
        }

        // Actualizaci칩n de tabla de transacciones
        function updateTransactionsTable() {
          const transactionsTable = document.getElementById('transactionsTable');
          const transactions = [
            { user: 'usuario1@example.com', type: 'Ingreso', category: 'Salario', amount: 1000, date: '2023-04-15' },
            { user: 'usuario2@example.com', type: 'Gasto', category: 'Comida', amount: 50, date: '2023-04-14' },
            { user: 'usuario3@example.com', type: 'Gasto', category: 'Transporte', amount: 30, date: '2023-04-13' }
          ];

          transactions.forEach(transaction => {
            const row = `
              <tr class="border-b border-gray-200 hover:bg-gray-100">
                <td class="py-3 px-6 text-left whitespace-nowrap">${transaction.user}</td>
                <td class="py-3 px-6 text-left">${transaction.type}</td>
                <td class="py-3 px-6 text-left">${transaction.category}</td>
                <td class="py-3 px-6 text-left">$${transaction.amount.toFixed(2)}</td>
                <td class="py-3 px-6 text-left">${transaction.date}</td>
              </tr>
            `;
            transactionsTable.innerHTML += row;
          });
        }

        // Evento de cierre de sesi칩n
        document.getElementById('logoutBtn').addEventListener('click', () => {
          firebase.auth().signOut().then(() => {
            window.location.href = '/login';
          }).catch((error) => {
            console.error("Error al cerrar sesi칩n:", error);
          });
        });

        // Cargar datos del dashboard al cargar la p치gina
        document.addEventListener('DOMContentLoaded', getDashboardData);
    </script>
</body>
</html>

</html>
